{"version":3,"sources":["main.js"],"names":["document","addEventListener","firebase","initializeApp","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","db","firestore","auth","form","querySelector","input","ul","login","logout","collection","signInAnonymously","signOut","e","preventDefault","value","trim","add","message","created_at","FieldValue","serverTimestamp","then","doc","console","log","id","focus","catch","error","onAuthStateChanged","user","orderBy","onSnapshot","snapshot","docChanges","forEach","change","type","li","createElement","textContent","data","appendChild","uid"],"mappings":";AACAA,SAASC,iBAAiB,mBAAoB,WAC9C,aAUEC,SAASC,cARI,CACXC,OAAQ,0CACRC,WAAY,mCACZC,YAAa,0CACbC,UAAW,mBACXC,cAAe,+BACfC,kBAAmB,iBAIfC,IAAAA,EAAKR,SAASS,YACdC,EAAOV,SAASU,OAGhBC,EAAOb,SAASc,cAAc,SAC9BC,EAAQf,SAASc,cAAc,UAE/BE,GADMhB,SAASc,cAAc,QACxBd,SAASc,cAAc,QAC5BG,EAAQjB,SAASc,cAAc,UAC/BI,EAASlB,SAASc,cAAc,WAEhCK,EAAaT,EAAGS,WAAW,QAEjCF,EAAMhB,iBAAiB,QAAS,WAC9BW,EAAKQ,sBAEPF,EAAOjB,iBAAiB,QAAS,WAC/BW,EAAKS,YAGPR,EAAKZ,iBAAiB,SAAU,SAAAqB,GAC9BA,EAAEC,iBAEY,KADAR,EAAMS,MAAMC,SAQ1BN,EAAWO,IAAI,CACbC,QAASZ,EAAMS,MACfI,WAAY1B,SAASS,UAAUkB,WAAWC,oBAE3CC,KAAK,SAAAC,GACJC,QAAQC,IAAOF,GAAAA,OAAAA,EAAIG,KACnBpB,EAAMS,MAAQ,GACdT,EAAMqB,UAEPC,MAAM,SAAAC,GACLL,QAAQK,MAAMA,KAEhBvB,EAAMqB,WAGRxB,EAAK2B,mBAAmB,SAAAC,GAClBA,GAAAA,EAYF,OAXArB,EAAWsB,QAAQ,aAAc,QAC9BC,WAAY,SAAAC,GACXA,EAASC,aAAaC,QAAS,SAAAC,GACzBA,GAAgB,UAAhBA,EAAOC,KAAkB,CACvBC,IAAAA,EAAKhD,SAASiD,cAAc,MAChCD,EAAGE,YAAuBJ,SAAAA,OAAAA,EAAOd,IAAImB,OAAOxB,QAA5C,KACAX,EAAGoC,YAAYJ,aAIvBf,QAAQC,IAAYM,QAAAA,OAAAA,EAAKa,MAG3BpB,QAAQC,IAAI","file":"main.04e092a1.map","sourceRoot":"../src","sourcesContent":["\ndocument.addEventListener('DOMContentLoaded', () => {\n'use strict';\n\n  var config = {\n    apiKey: \"AIzaSyCbwkLe6ZFPLMxAoT7iNjSKEFf6hsCuXZA\",\n    authDomain: \"test-store-b68ee.firebaseapp.com\",\n    databaseURL: \"https://test-store-b68ee.firebaseio.com\",\n    projectId: \"test-store-b68ee\",\n    storageBucket: \"test-store-b68ee.appspot.com\",\n    messagingSenderId: \"184450022187\"\n  };\n  firebase.initializeApp(config);\n\n  const db = firebase.firestore()\n  const auth = firebase.auth()\n  // const settings = { timestampsInSnapshots: true }\n  // db.settings(settings)\n  const form = document.querySelector('#form')\n  const input = document.querySelector('#input')\n  const btn = document.querySelector('#btn') \n  const ul = document.querySelector('#ul');\n  const login = document.querySelector('#login');\n  const logout = document.querySelector('#logout');\n\n  const collection = db.collection('atom')\n\n  login.addEventListener('click', () => {\n    auth.signInAnonymously()\n  })\n  logout.addEventListener('click', () => {\n    auth.signOut();\n  })\n\n  form.addEventListener('submit', e => {\n    e.preventDefault();\n    const value = input.value.trim()\n    if (value === \"\") return\n    \n    // ダイレクト記載分\n    // let li = document.createElement('li')\n    // li.textContent = value\n    // ul.appendChild(li)\n\n    collection.add({\n      message: input.value,\n      created_at: firebase.firestore.FieldValue.serverTimestamp()\n    })\n    .then(doc=> {\n      console.log(`${doc.id}`);\n      input.value = ''\n      input.focus()\n    })\n    .catch(error => {\n      console.error(error)\n    })\n    input.focus()\n  })\n\n  auth.onAuthStateChanged(user => {\n    if (user) {\n      collection.orderBy('created_at', 'desc')\n        .onSnapshot( snapshot => {\n          snapshot.docChanges().forEach( change => {\n            if (change.type === 'added') {\n              let li = document.createElement('li')\n              li.textContent = `data: ${change.doc.data().message} `\n              ul.appendChild(li)\n            }\n          })\n        })\n      console.log(`uid: ${user.uid}`)\n      return\n    }\n    console.log('Nobody is login')\n  })\n\n})\n  "]}